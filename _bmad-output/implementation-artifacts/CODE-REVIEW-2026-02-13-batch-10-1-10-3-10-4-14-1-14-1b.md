# Code Review — Batch 10-1, 10-3, 10-4, 14-1, 14-1b

**Date:** 2026-02-13  
**Workflow:** Adversarial Code Review  
**Stories:** 10-1 (Home), 10-3 (Leagues), 10-4 (Join), 14-1 (Design Tokens), 14-1b (Design System Showcase)

---

## Git vs Story Discrepancies

**Uncommitted changes (git status):**
- Modified: 14-7, 14-8 story files, sprint-status, index.ts, DesignSystemShowcase, DesignSystemShowcase.test
- New: Banner.tsx, SearchBar.tsx, Banner.test, SearchBar.test

**Note:** Stories 14-7 and 14-8 are not in this review batch. Their files appear in git because they were implemented in the same session.

---

## Findings Summary

| Story | High | Medium | Low |
|-------|------|--------|-----|
| 10-1 | 0 | 0 | 0 |
| 10-3 | 0 | 1 | 0 |
| 10-4 | 0 | 0 | 0 |
| 14-1 | 0 | 0 | 0 |
| 14-1b | 0 | 1 | 2 |

---

## CRITICAL ISSUES

*Aucun*

---

## MEDIUM ISSUES

### [10-3] Leagues: PaymentModal sans onSuccess

**Fichier:** `src/pages/Leagues.tsx`  
**Problème:** Après un upgrade Premium via le modal (limite league atteinte), la page ne rafraîchit pas le statut premium. L'utilisateur reste bloqué sur "limite atteinte" jusqu'à un rechargement.

**Comparaison:** Home.tsx passe `onSuccess={handlePaymentSuccess}` avec `refetchPremium()` et `invalidateQueries`. Leagues et Tournaments ne passent pas `onSuccess`.

**Recommandation:** Ajouter `onSuccess` qui invalide le contexte premium / refetch usePremiumLimits (ou équivalent selon l'architecture).

---

### [14-1b] DesignSystemShowcase: Banner non testé

**Fichier:** `tests/unit/pages/DesignSystemShowcase.test.tsx`  
**Problème:** AC3 exige la section Banner dans les composants. Le test ne vérifie pas que Banner est rendu. Si Banner est retiré par erreur, le test continuera de passer.

**Recommandation:** Ajouter une assertion du type `expect(screen.getByText(/Tournoi rejoint/)).toBeInTheDocument()` ou équivalent.

---

## LOW ISSUES

### [14-1b] Banner dismissable : démo non interactive

**Fichier:** `src/pages/DesignSystemShowcase.tsx`  
**Problème:** Le Banner avec `onDismiss={() => {}}` ne masque pas la bannière au clic sur X. La démo ne montre pas le comportement dismiss.

**Recommandation:** Utiliser un state local pour masquer la bannière au clic (ex. `useState` + condition de rendu).

---

### [14-1b] Padding bottom redondant

**Fichier:** `src/pages/DesignSystemShowcase.tsx`  
**Problème:** La page utilise `pb-24` alors que la bottom nav est masquée sur `/design-system`. Padding inutile.

**Recommandation:** Retirer `pb-24` ou le remplacer par un padding plus faible (ex. `pb-8`).

---

## Stories 10-1, 10-4, 14-1

Aucun problème bloquant identifié. Les corrections des revues précédentes sont bien intégrées.

---

## Résumé des corrections appliquées

| Story | Fix |
|-------|-----|
| 10-3 | PaymentModal: onSuccess → reloadData() |
| 14-1b | Banner test ajouté, BannerShowcase dismiss interactif, pb-24 → pb-8 |
